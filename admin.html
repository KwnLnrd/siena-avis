<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Unifié - Siena</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@600;700&family=Montserrat:wght@400;500;600&display=swap');
        :root {
            --brand-color: #BF5B3F;
            --background-color: #FDFBF5;
            --surface-color: #FFFFFF;
            --text-primary: #2C2C2C;
            --text-secondary: #737373;
            --border-color: #EAE0D5;
            --font-serif: 'Cormorant Garamond', serif;
            --font-sans: 'Montserrat', sans-serif;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        
        /* --- Styles Généraux --- */
        body {
            font-family: var(--font-sans);
            background-color: var(--background-color);
            color: var(--text-primary);
            margin: 0;
            padding: 20px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            animation: fadeIn .8s ease-out;
        }
        .hidden { display: none !important; }

        /* --- Styles du Modal de Mot de Passe (inchangé) --- */
        .modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.6);display:flex;justify-content:center;align-items:center;z-index:1000;backdrop-filter:blur(5px)}
        .modal-content{background:var(--surface-color);padding:40px;border-radius:16px;box-shadow:0 10px 50px rgba(0,0,0,.2);text-align:center;width:100%;max-width:400px}
        .modal-content h2{font-family:var(--font-serif);font-size:1.8rem;margin-top:0;margin-bottom:15px}
        .modal-content p{margin-bottom:25px;color:var(--text-secondary)}
        #password-form input{width:100%;padding:12px;border:1px solid var(--border-color);border-radius:8px;font-size:1rem;box-sizing:border-box;margin-bottom:15px}
        #password-form button{background-color:var(--brand-color);color:#fff;border:none;padding:14px;border-radius:8px;font-size:1rem;font-weight:600;cursor:pointer;width:100%;transition:background-color .2s}
        #password-form button:disabled{background-color:var(--text-secondary);cursor:wait}
        .error-message{color:#D32F2F;font-size:.9rem;margin-top:10px;min-height:1.2em}

        /* --- Header et Navigation par Onglets --- */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 20px;
        }
        .header h1 {
            font-family: var(--font-serif);
            font-size: 2.5rem;
            margin: 0;
        }
        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 1px solid var(--border-color);
        }
        .nav-tab {
            padding: 12px 22px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-secondary);
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
        }
        .nav-tab:hover { color: var(--text-primary); }
        .nav-tab.active {
            color: var(--brand-color);
            border-bottom-color: var(--brand-color);
        }

        /* --- Contenu des Onglets --- */
        .tab-content {
            animation: fadeIn .5s ease-out;
        }
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
        }
        .card {
            background-color: var(--surface-color);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 20px -5px rgba(133, 93, 67, .1);
        }
        .card-full { grid-column: 1 / -1; }
        .card-title {
            font-family: var(--font-serif);
            font-size: 1.8rem;
            margin-top: 0;
            margin-bottom: 20px;
            color: var(--brand-color);
        }
        
        /* Styles spécifiques pour les tableaux */
        table { width: 100%; border-collapse: collapse; text-align: left; }
        th, td { padding: 12px 15px; border-bottom: 1px solid var(--border-color); }
        th { font-weight: 600; cursor: pointer; }
        th:hover { color: var(--brand-color); }

        /* Styles spécifiques pour Feedback Interne */
        .feedback-list { display: grid; gap: 20px; }
        .feedback-card {
            background-color: var(--surface-color);
            border: 1px solid var(--border-color);
            border-left-width: 5px;
            border-radius: 8px;
            padding: 20px;
        }
        .feedback-card[data-status="new"] { border-left-color: #1565C0; }
        .feedback-card[data-status="read"] { border-left-color: #757575; }
        .feedback-card[data-status="archived"] { border-left-color: #FFB74D; opacity: 0.8; }
        .feedback-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; font-size: 0.9rem; }
        .feedback-actions button {
            border: 1px solid var(--border-color); background-color: #fff; color: var(--text-primary);
            padding: 8px 15px; border-radius: 6px; cursor: pointer; font-weight: 500;
        }

        /* Styles spécifiques pour Gestion */
        .item-list { list-style: none; padding: 0; margin: 0; }
        .item-list li { display: flex; justify-content: space-between; align-items: center; padding: 10px 5px; border-bottom: 1px solid var(--border-color); }
        .delete-btn { background: none; border: none; color: #D32F2F; cursor: pointer; font-size: 1.2rem; }
        .add-form { display: flex; flex-direction: column; gap: 10px; margin-top: 20px; }
        .add-form input, .add-form select { width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 1rem; box-sizing: border-box; }
        .add-form button { background-color: var(--brand-color); color: #fff; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; }
    </style>
</head>
<body>

    <!-- MODAL MOT DE PASSE -->
    <div id="password-modal" class="modal-overlay">
        <div class="modal-content">
            <h2>Accès Sécurisé</h2>
            <p>Veuillez entrer le mot de passe pour accéder au tableau de bord.</p>
            <form id="password-form">
                <input type="password" id="password-input" placeholder="Mot de passe" required>
                <button type="submit" id="submit-password-btn">Valider</button>
            </form>
            <p id="password-error" class="error-message"></p>
        </div>
    </div>

    <!-- CONTENU PRINCIPAL DU DASHBOARD -->
    <div class="main-container hidden" id="main-content">
        <header class="header">
            <h1>Tableau de Bord Siena</h1>
        </header>

        <!-- NAVIGATION PAR ONGLETS -->
        <nav class="nav-tabs">
            <button class="nav-tab active" data-tab="overview">Vue d'ensemble</button>
            <button class="nav-tab" data-tab="performance">Performance Menu</button>
            <button class="nav-tab" data-tab="feedback">Feedback Interne</button>
            <button class="nav-tab" data-tab="manage">Gestion</button>
        </nav>

        <!-- CONTENEURS DE CONTENU POUR CHAQUE ONGLET -->
        <main>
            <!-- Onglet 1: Vue d'ensemble -->
            <div id="overview-tab" class="tab-content">
                <div class="dashboard-grid">
                    <div class="card">
                        <h2 class="card-title">Classement des Avis</h2>
                        <table id="ranking-table">
                            <thead><tr><th>#</th><th>Serveur</th><th style="text-align:right;">Avis</th></tr></thead>
                            <tbody><tr><td colspan="3">Chargement...</td></tr></tbody>
                        </table>
                    </div>
                    <div class="card">
                        <h2 class="card-title">Top 3 des Serveurs</h2>
                        <canvas id="top3-chart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Onglet 2: Performance Menu -->
            <div id="performance-tab" class="tab-content hidden">
                <div class="card card-full">
                    <div class="filters" style="display:flex; gap:20px; margin-bottom:20px;">
                        <div>
                            <label for="period-filter">Période :</label>
                            <select id="period-filter">
                                <option value="all">Tout</option>
                                <option value="30days">30 derniers jours</option>
                                <option value="7days">7 derniers jours</option>
                            </select>
                        </div>
                        <div>
                            <label for="category-filter">Catégorie :</label>
                            <select id="category-filter"><option value="all">Toutes</option></select>
                        </div>
                    </div>
                    <div class="dashboard-grid">
                        <div class="card">
                            <h2 class="card-title">Top 10 des Plats</h2>
                            <canvas id="top-10-chart"></canvas>
                        </div>
                        <div class="card">
                            <h2 class="card-title">Données Complètes</h2>
                            <div id="full-data-table-container"><p>Chargement...</p></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Onglet 3: Feedback Interne -->
            <div id="feedback-tab" class="tab-content hidden">
                <div class="card card-full">
                    <div class="nav-tabs" id="feedback-status-tabs">
                        <button class="nav-tab active" data-status="new">Nouveaux</button>
                        <button class="nav-tab" data-status="read">Lus</button>
                        <button class="nav-tab" data-status="archived">Archivés</button>
                    </div>
                    <div id="feedback-list" class="feedback-list">
                        <p>Chargement des feedbacks...</p>
                    </div>
                </div>
            </div>

            <!-- Onglet 4: Gestion -->
            <div id="manage-tab" class="tab-content hidden">
                <div class="dashboard-grid">
                    <div class="card" id="servers-section">
                        <h2 class="card-title">Gérer les Serveurs</h2>
                        <ul id="servers-list" class="item-list"></ul>
                        <form id="add-server-form" class="add-form">
                            <input type="text" id="new-server-name" placeholder="Prénom du nouveau serveur" required>
                            <button type="submit">Ajouter Serveur</button>
                        </form>
                    </div>
                    <div class="card" id="flavors-section">
                        <h2 class="card-title">Gérer les Plats (Saveurs)</h2>
                        <ul id="flavors-list" class="item-list"></ul>
                        <form id="add-flavor-form" class="add-form">
                            <input type="text" id="new-flavor-text" placeholder="Nom du plat" required>
                            <select id="new-flavor-category" required>
                                <option value="" disabled selected>Choisir une catégorie</option>
                                <option value="Antipasti & Crudo">Antipasti & Crudo</option>
                                <option value="Pâtes">Pâtes</option>
                                <option value="Viandes & Poissons">Viandes & Poissons</option>
                                <option value="Pizze">Pizze</option>
                                <option value="Douceurs">Douceurs</option>
                            </select>
                            <button type="submit">Ajouter Plat</button>
                        </form>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- VARIABLES GLOBALES ET CONSTANTES ---
            const API_BASE_URL = 'https://siena-avis.onrender.com';
            let currentPassword = '';
            let dataCache = {}; // Pour mettre en cache les données chargées
            let charts = {}; // Pour stocker les instances de graphiques

            // --- ÉLÉMENTS DU DOM ---
            const passwordModal = document.getElementById('password-modal');
            const passwordForm = document.getElementById('password-form');
            const passwordInput = document.getElementById('password-input');
            const passwordError = document.getElementById('password-error');
            const submitBtn = document.getElementById('submit-password-btn');
            const mainContent = document.getElementById('main-content');
            const tabs = document.querySelectorAll('.nav-tab[data-tab]');
            const tabContents = document.querySelectorAll('.tab-content');

            // --- GESTION DE L'AUTHENTIFICATION ---
            const storedPassword = sessionStorage.getItem('dashboardPassword');
            if (storedPassword) {
                passwordModal.classList.add('hidden');
                mainContent.classList.remove('hidden');
                currentPassword = storedPassword;
                loadDataForTab('overview'); // Charger les données du premier onglet
            }

            passwordForm.addEventListener('submit', (e) => {
                e.preventDefault();
                currentPassword = passwordInput.value;
                if (!currentPassword) return;
                
                submitBtn.disabled = true;
                submitBtn.textContent = 'Vérification...';
                
                // On teste la connexion avec le premier endpoint
                fetchWithAuth(`${API_BASE_URL}/dashboard`)
                    .then(() => {
                        sessionStorage.setItem('dashboardPassword', currentPassword);
                        passwordModal.classList.add('hidden');
                        mainContent.classList.remove('hidden');
                        loadDataForTab('overview');
                    })
                    .catch(error => {
                        passwordError.textContent = error.message;
                    })
                    .finally(() => {
                        submitBtn.disabled = false;
                        submitBtn.textContent = 'Valider';
                    });
            });

            async function fetchWithAuth(url, options = {}) {
                const headers = { ...options.headers, 'Authorization': 'Basic ' + btoa('admin:' + currentPassword) };
                const response = await fetch(url, { ...options, headers });
                if (response.status === 401) {
                    sessionStorage.removeItem('dashboardPassword');
                    window.location.reload();
                    throw new Error("Mot de passe incorrect ou session expirée.");
                }
                if (!response.ok) throw new Error(`Erreur du serveur (status ${response.status})`);
                const contentType = response.headers.get("content-type");
                return contentType?.includes("application/json") ? response.json() : response.text();
            }

            // --- GESTION DE LA NAVIGATION PAR ONGLETS ---
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Gérer l'état actif des onglets
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    // Afficher le bon contenu
                    const tabName = tab.dataset.tab;
                    tabContents.forEach(content => {
                        content.classList.toggle('hidden', content.id !== `${tabName}-tab`);
                    });

                    loadDataForTab(tabName);
                });
            });
            
            function loadDataForTab(tabName) {
                // Ne recharge pas les données si elles sont déjà en cache
                if (dataCache[tabName]) return;

                switch(tabName) {
                    case 'overview':
                        loadOverviewData();
                        break;
                    case 'performance':
                        loadMenuPerformanceData();
                        break;
                    case 'feedback':
                        loadInternalFeedbackData('new');
                        break;
                    case 'manage':
                        loadManagementData();
                        break;
                }
            }

            // --- LOGIQUE POUR L'ONGLET "VUE D'ENSEMBLE" ---
            async function loadOverviewData() {
                try {
                    const data = await fetchWithAuth(`${API_BASE_URL}/dashboard`);
                    dataCache.overview = data;
                    
                    const rankingTableBody = document.querySelector('#ranking-table tbody');
                    rankingTableBody.innerHTML = '';
                    if (data.length === 0) {
                        rankingTableBody.innerHTML = '<tr><td colspan="3" style="text-align:center;">Aucun avis.</td></tr>';
                    } else {
                        data.forEach((item, index) => {
                            rankingTableBody.innerHTML += `<tr><td>${index + 1}</td><td>${item.server}</td><td style="text-align:right;">${item.count}</td></tr>`;
                        });
                    }

                    if (charts.top3) charts.top3.destroy();
                    const top3Data = data.slice(0, 3);
                    charts.top3 = new Chart(document.getElementById('top3-chart'), {
                        type: 'bar',
                        data: {
                            labels: top3Data.map(item => item.server),
                            datasets: [{
                                label: 'Avis',
                                data: top3Data.map(item => item.count),
                                backgroundColor: 'rgba(191, 91, 63, 0.8)'
                            }]
                        },
                        options: { indexAxis: 'y', responsive: true, plugins: { legend: { display: false } } }
                    });
                } catch (error) {
                    console.error("Erreur chargement Overview:", error);
                }
            }

            // --- LOGIQUE POUR L'ONGLET "PERFORMANCE MENU" ---
            const performanceState = { allData: [], currentSort: { column: 'selection_count', direction: 'desc' } };
            const periodFilter = document.getElementById('period-filter');
            const categoryFilter = document.getElementById('category-filter');
            const tableContainer = document.getElementById('full-data-table-container');

            async function loadMenuPerformanceData() {
                const period = periodFilter.value;
                try {
                    const data = await fetchWithAuth(`${API_BASE_URL}/api/menu-performance?period=${period}`);
                    performanceState.allData = data;
                    dataCache.performance = true; // Marquer comme chargé
                    
                    const categories = [...new Set(data.map(item => item.dish_category))];
                    categoryFilter.innerHTML = '<option value="all">Toutes les catégories</option>';
                    categories.sort().forEach(cat => {
                        categoryFilter.innerHTML += `<option value="${cat}">${cat}</option>`;
                    });
                    
                    renderPerformance();
                } catch (error) {
                    console.error("Erreur chargement Performance:", error);
                    tableContainer.innerHTML = `<p>${error.message}</p>`;
                }
            }

            function renderPerformance() {
                let filteredData = performanceState.allData;
                if (categoryFilter.value !== 'all') {
                    filteredData = performanceState.allData.filter(item => item.dish_category === categoryFilter.value);
                }

                // Render Top 10 Chart
                if (charts.top10) charts.top10.destroy();
                const top10Data = [...filteredData].sort((a, b) => b.selection_count - a.selection_count).slice(0, 10);
                charts.top10 = new Chart(document.getElementById('top-10-chart'), {
                    type: 'bar',
                    data: {
                        labels: top10Data.map(d => d.dish_name),
                        datasets: [{ label: 'Sélections', data: top10Data.map(d => d.selection_count), backgroundColor: 'rgba(191, 91, 63, 0.8)' }]
                    },
                    options: { indexAxis: 'y', responsive: true, plugins: { legend: { display: false } } }
                });

                // Render Data Table
                const sortedData = [...filteredData].sort((a, b) => {
                    const comparison = a[performanceState.currentSort.column] > b[performanceState.currentSort.column] ? 1 : -1;
                    return performanceState.currentSort.direction === 'asc' ? comparison : -comparison;
                });
                
                let tableHTML = '<table><thead><tr><th data-sort="dish_name">Plat</th><th data-sort="dish_category">Catégorie</th><th data-sort="selection_count">Sélections</th></tr></thead><tbody>';
                sortedData.forEach(item => {
                    tableHTML += `<tr><td>${item.dish_name}</td><td>${item.dish_category}</td><td>${item.selection_count}</td></tr>`;
                });
                tableHTML += '</tbody></table>';
                tableContainer.innerHTML = tableHTML;
            }
            
            periodFilter.addEventListener('change', loadMenuPerformanceData);
            categoryFilter.addEventListener('change', renderPerformance);
            tableContainer.addEventListener('click', (e) => {
                if (e.target.dataset.sort) {
                    const column = e.target.dataset.sort;
                    if (performanceState.currentSort.column === column) {
                        performanceState.currentSort.direction = performanceState.currentSort.direction === 'asc' ? 'desc' : 'asc';
                    } else {
                        performanceState.currentSort.column = column;
                        performanceState.currentSort.direction = 'desc';
                    }
                    renderPerformance();
                }
            });


            // --- LOGIQUE POUR L'ONGLET "FEEDBACK INTERNE" ---
            const feedbackState = { currentStatus: 'new' };
            const feedbackTabsContainer = document.getElementById('feedback-status-tabs');
            const feedbackListContainer = document.getElementById('feedback-list');

            async function loadInternalFeedbackData(status) {
                feedbackState.currentStatus = status;
                feedbackListContainer.innerHTML = '<p>Chargement...</p>';
                
                feedbackTabsContainer.querySelectorAll('.nav-tab').forEach(t => t.classList.toggle('active', t.dataset.status === status));

                try {
                    const feedbacks = await fetchWithAuth(`${API_BASE_URL}/api/internal-feedback?status=${status}`);
                    dataCache.feedback = true; // Marquer comme chargé
                    feedbackListContainer.innerHTML = '';
                    if (feedbacks.length === 0) {
                        feedbackListContainer.innerHTML = '<p>Aucun feedback dans cette catégorie.</p>';
                        return;
                    }
                    feedbacks.forEach(fb => {
                        const card = document.createElement('div');
                        card.className = 'feedback-card';
                        card.dataset.id = fb.id;
                        card.dataset.status = fb.status;
                        const formattedDate = new Date(fb.created_at).toLocaleString('fr-FR');
                        let actionsHTML = '';
                        if (fb.status === 'new') actionsHTML = `<button data-action="read">Marquer lu</button>`;
                        if (fb.status === 'read') actionsHTML = `<button data-action="archive">Archiver</button>`;
                        if (fb.status === 'archived') actionsHTML = `<button data-action="new">Réactiver</button>`;

                        card.innerHTML = `
                            <div class="feedback-header"><span>Serveur: ${fb.server_name}</span><span>${formattedDate}</span></div>
                            <p>${fb.feedback_text}</p>
                            <div class="feedback-actions">${actionsHTML}</div>`;
                        feedbackListContainer.appendChild(card);
                    });
                } catch (error) {
                    console.error("Erreur chargement Feedback:", error);
                    feedbackListContainer.innerHTML = `<p>${error.message}</p>`;
                }
            }

            feedbackTabsContainer.addEventListener('click', (e) => {
                if (e.target.dataset.status) {
                    loadInternalFeedbackData(e.target.dataset.status);
                }
            });

            feedbackListContainer.addEventListener('click', async (e) => {
                if (e.target.dataset.action) {
                    const card = e.target.closest('.feedback-card');
                    const id = card.dataset.id;
                    const action = e.target.dataset.action;
                    let newStatus = '';
                    if (action === 'read') newStatus = 'read';
                    if (action === 'archive') newStatus = 'archived';
                    if (action === 'new') newStatus = 'new';
                    
                    try {
                        await fetchWithAuth(`${API_BASE_URL}/api/internal-feedback/${id}/status`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ status: newStatus })
                        });
                        loadInternalFeedbackData(feedbackState.currentStatus); // Refresh view
                    } catch (error) {
                        alert(`Erreur: ${error.message}`);
                    }
                }
            });

            // --- LOGIQUE POUR L'ONGLET "GESTION" ---
            const manageElements = {
                servers: { list: document.getElementById('servers-list'), form: document.getElementById('add-server-form'), input: document.getElementById('new-server-name') },
                flavors: { list: document.getElementById('flavors-list'), form: document.getElementById('add-flavor-form'), inputText: document.getElementById('new-flavor-text'), inputCategory: document.getElementById('new-flavor-category') }
            };

            async function loadManagementData() {
                try {
                    const [servers, flavors] = await Promise.all([
                        fetchWithAuth(`${API_BASE_URL}/api/servers`),
                        fetchWithAuth(`${API_BASE_URL}/api/options/flavors`)
                    ]);
                    dataCache.manage = true; // Marquer comme chargé
                    populateManageList(manageElements.servers.list, servers, 'servers');
                    populateManageList(manageElements.flavors.list, flavors, 'flavors');
                } catch (error) {
                    console.error("Erreur chargement Gestion:", error);
                }
            }

            function populateManageList(listElement, items, type) {
                listElement.innerHTML = '';
                if (items.length === 0) { listElement.innerHTML = '<li>Aucun élément.</li>'; return; }
                items.forEach(item => {
                    const text = item.name || item.text;
                    const category = item.category ? ` <em>(${item.category})</em>` : '';
                    listElement.innerHTML += `<li><span>${text}${category}</span><button class="delete-btn" data-id="${item.id}" data-type="${type}">×</button></li>`;
                });
            }

            manageElements.servers.form.addEventListener('submit', async (e) => {
                e.preventDefault();
                const name = manageElements.servers.input.value.trim();
                if (!name) return;
                await fetchWithAuth(`${API_BASE_URL}/api/servers`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ name }) });
                manageElements.servers.input.value = '';
                loadManagementData();
            });

            manageElements.flavors.form.addEventListener('submit', async (e) => {
                e.preventDefault();
                const text = manageElements.flavors.inputText.value.trim();
                const category = manageElements.flavors.inputCategory.value;
                if (!text || !category) return;
                await fetchWithAuth(`${API_BASE_URL}/api/options/flavors`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ text, category }) });
                manageElements.flavors.inputText.value = '';
                manageElements.flavors.inputCategory.value = '';
                loadManagementData();
            });

            document.getElementById('manage-tab').addEventListener('click', async (e) => {
                if (e.target.classList.contains('delete-btn')) {
                    const { id, type } = e.target.dataset;
                    const endpoint = type === 'servers' ? `/api/servers/${id}` : `/api/options/flavors/${id}`;
                    if (confirm('Êtes-vous sûr ?')) {
                        await fetchWithAuth(`${API_BASE_URL}${endpoint}`, { method: 'DELETE' });
                        loadManagementData();
                    }
                }
            });
        });
    </script>
</body>
</html>
